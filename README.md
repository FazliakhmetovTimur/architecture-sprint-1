## Задание 1

### Разделение на бизнес-функции

* Авторизация
* Регистрация
* Управление фотографиями (добавление, удаление, лайки)
* Управление профилем

Это достаточно самостоятельные функции, который могут разиваться автономно. В то же время функции авторизации и регистрации достаточно небольшие и предметно связаны между собой. Я оставил их в одном микрофронте.

При этом важно выделить два момента, требующих общие компоненты:

1. Пользовательская сессия. Реализуется через общий компонент ./libs/scr/context/CurrentUserContext.js
   1. Доступ к управлению фотографиями и профилем должен быть только у авторизованных пользователей.
   2. Набор фотографий и профиль выбираются, исходя из ученой записи.
2. Header и Footer у всех микрофронтов должен быть одинаковый. Реализуется в главном приложении ./mainapp/src/App.js
3. API для проверки токена.

Реализация зависимостей показана ниже.

### Метод интеграции

В настоящее время приложение небольшое, поэтому достаточно была бы интеграция build-time. Однако, уже можно предугадать, что управление фотографиями может меняться существенно быстрее. Поэтому лучше сразу заложить run-time.

### Метод композиции

Мое решение - использовать гибридную композицию. На мой взгляд в 80-90% случаев будут использоваться микрофротенды авторизации и управления фотографиями. А при достаточно долгом сохранении сессии - только управления фотографиями. Поэтому сразу загружать все микрофронты смысла не вижу. Их можно грузить только при выборе соответствующей функции в UI.

### Инструмент

В качестве инструмента выбран Webpack Module Federation.

Обоснование:

* Пока каждый микрофронт реализован на react. Следовательно, нужен будет шаринг общих библиотек react-а.
* Функция `checkToken `будет вынесена в отдельную общую библиотеку. Следовательно, нужен будет ее шаринг.
* Есть общая глобальная переменная, хранящая сессию пользователя.

### Структура проектов

#### Общие компоненты для всех микрофронтов

/libs //Директория общих компонентов

/images //общая графика

/src //Исходники общих компонент

В будущем сюда также можно вынести общие UI компоненты вместе со своими css.

/context/CurrentUserContext.js // Переменная для пользовательской сессии

В данном проекте для связи между микрофронтами выбрано решение использовать общую переменную. Причинав в том, что все микрофронты должны иметь общее состояние пользовательской сессии. Можно было бы сделать это через API/BFF, но я исходил из того, что бек не меняется.

/api/auth.js //Содержить фукнцию проверки токена

/styles //css, формирующие общий стиль приложения

#### Главное приложение

/mainapp //Директория для главного приложения

index.js //точка входа в главное приложения

/api //API главного приложения

/src //Исходники главного приложения

App.js //Основное приложение

По дефолту маршрутизирует на микрофронт авторизации. Проверяет, есть ли токен. Если есть, то на управление фотографиями. В коде это не реализовано, так как разобраться с React и WMF за разумное время не удалосьь

Используеться для:

1) Отрисовки Header и Footer
2) Проверки токена и активной сессии пользователя при монтировании
3) Загрузки остальных микрофронтов.
4) Все остальные сеттеры и обработчики, кроме выхода из сессии (OnSignOut) переезжают в соотвествующие микрофронты. OnSignOut нужен здесь, так как вызывается из Header.

Header.js // Заголовок.

Отбражается либо e-mail текущего пользователя и кнопку выхода, либо кнопки для входа/регистрации

Footer.js // Статусная строка

/styles //Специфичные стили для главного приложения

webpack.config.js //конфиг Module Federationдля главного приложения

#### Микрофронтенды

/components //директория для микрофронтов

##### Авторизация и регистрация

/auth-mf //директория для микрофронта авторизации

index.js //точка входа в микрофронт

/api //API микрофронта

Содержит фукции авторизации и регистрации

/src //Исходники

Login.js //форма для логина

Register.js //форма для регистрации

InfoTooltip.js //всплывающее окно при успешной или неуспешном входе.

/styles //Специфичные стили для микрофронта авторизации

webpack.config.js //конфиг Module Federation для микрофронта

##### Управление фотографиями

index.js //точка входа в микрофронт

/imagescontrol-mf //директория для микрофронта управления фотографиями

/api //API микрофронта

Содержит функции получения, добавления, удаления, лайка картинок

/src //Исходники

ImagesControl.js //Главная форма для отображения фотографий

Предалагается, что загрузка фотографий должна выполняется через Lazy loading, чтобы не вытаскивать все фото разом. Тем самым сократить время первой загрузки.

Остальные компоненты не описаны, так как детально не проработаны и не декомпозированы.

/styles //Специфичные стили для управления фотографиями

webpack.config.js //конфиг Module Federation для микрофронта

##### Управление профилем

index.js //точка входа в микрофронт

/profile-microfrontend //директория для микрофронта управления профилем

/api //API микрофронта

Содержит функции получения инфо о пользователе, изменения имени и аватарки

/src //Исходники

EditProfileForm.js //Главная форма для отображения профиля

Остальные компоненты не описаны, так как детально не проработаны и не декомпозированы.

/styles //Специфичные стили для управления профилем

webpack.config.js //конфиг Module Federation для микрофронта

## Задание 2

Ссылка на схему:

[https://drive.google.com/file/d/15sbKavy18Ss_ssc6Yf3Qcw5pqDPU7Myj/view?usp=sharing](https://)

Схема получась громозкая, так как я детально изобразил потоки. Как это сделать проще и читабельнее, понял только, когда уже все закончил. Потратил очень много времени, поэтому не стал переделывать.

Сценарии обращения в техподдержку вынес на отдельную схема справа от основной. Для экономии времени потока указах по-крупному и описывать не стал.
